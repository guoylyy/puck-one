## 笃师一对一

### 1. 使用的前端库包括：

（1）UI库：SUI Mobile <http://m.sui.taobao.org>
（2）模块化开发：Sea.js <http://seajs.org>
（3）构建工具：Gulp <http://www.gulpjs.com.cn>

### 2. 代码结构说明

主要逻辑代码都在`src/js/chat.js`文件中，笃师一对一代码的主要逻辑是：
 
  1. 获取通过微信进入笃师一对一页面的用户登录信息以及对应课程的`clazzId`，笃师一对一页面跳转的URL为：`http://host:port/theOne/xxxxxxx`，其中`xxxxxx`为`clazzId`
  2. 通过用户登录信息，调用是否为笃师的API，笃师则跳转到一对一学员列表页面，学员则直接跳转到一对一会话页面
  3. 笃师在一对一学员列表页面，调用API拉取对应课程的学员信息，学员的回复状态包括：`待提交(SUBMITTING)`、`未回复(WAITING)`、`已回复(REPLIED)`、`已关闭(CLOSED)`，笃师点击单个学员，进入与该学员对应的一对一会话页面
  4. 学员在一对一会话页面，直接与该课程对应的笃师进行一对一会话
  5. 在一对一会话页面，学员可以发送文字和语音，笃师可以发送文字、语音和素材，其中语音使用了微信JS—SDK的接口
  
`src/js/chat.js`文件中的函数，以`init`开头的函数主要做一些初始化操作，以`on`开头的函数主要是事件绑定函数，以`ajax`开头的函数主要是接口调用函数，其中几个主要函数说明：

  1. `initPage`用来绑定各个页面初始化事件触发的函数，以及页面上下滑动事件触发的函数
  2. `initPageHtml`用来绘制不同的一对一会话页面，笃师增加了发送素材的按钮
  3. `initWeixinSDK`用来初始化微信JS-SDK，主要是一些鉴权操作，保证后面调用录音接口可以成功
  4. `bindVoiceRecordEvents`绑定录音面板各个按钮触发的事件
  5. `onClickChatOption`点击一对一会话页面下来的操作按钮触发的事件，用来展示/隐藏录音面板、文字发送面板或跳转到素材页面
  6. `onClickVoiceMsg`点击会话列表中的语音信息触发的事件，用来播放语音信息，直接使用了`Audio`
  7. `addMessageHtml`向会话列表中添加不同类型的消息的html结构






